# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure(2) do |config|
  config.vm.box = "centos/7"

  # Hostname
  config.vm.hostname = "centos"
  config.vm.usable_port_range= 2800..2900

  # Create a private network, which allows host-only access to the machine
  # using a specific IP.
  config.vm.network "private_network", ip: "172.16.0.101"
  config.vm.network "private_network", ip: "172.10.0.200"
  config.vm.network "forwarded_port", guest: 80, host: 2899
  config.vm.network "forwarded_port", guest: 8080, host: 2900

  # Provider-specific configuration so you can fine-tune various
  # backing providers for Vagrant. These expose provider-specific options.
  config.vm.provider "virtualbox" do |vb|
   # Customize the amount of memory on the VM:
   vb.memory = "1024"

   nvme_disk = 'nvme.vdi'
      unless File.exist? (nvme_disk)
        vb.customize ["createhd", "--filename", nvme_disk, "--variant", "Fixed", "--size", "1024"]
        vb.customize ["storagectl", :id, "--name", "nvme", "--add", "pcie", "--controller", "NVMe", "--hostiocache", "off", "--portcount", "4", "--bootable", "off"]
        vb.customize ["storageattach", :id, "--storagectl", "nvme", "--type", "hdd", "--medium", nvme_disk, "--port", "0", "--nonrotational", "off"]
      end

  end # end Provider

end # end configure(2)
